/*
 * Playbook contains multiple rules which monitors SRX cluster system,
 * linecard, SPU's CPU & Memory and security parameters and notifies when
 * anomalies are found.
 *
 * 1) Rule "check-spu-performance-srx-cluster-netconf" collects SPU performance 
 *    for each PIC and notifies in case of stats is above threshold.
 * 2) Rule "check-flow-session-summary-srx-cluster-netconf" collects and  
 *    monitors the active flow session details and notifies anomalies.
 * 3) Rule "check-fpc-cpu-memory-usage-srx-cluster-netconf" collects system FPC 
 *    CPU statistics periodically and notifies anomalies when CPU utilization 
 *    exceed threshold.
 * 4) Rule "check-interface-in-out-traffic-snmp" collects input and output
 *    traffic periodically and notifies in case of traffic is above threshold.
 * 5) Rule "check-system-cpu-memory-snmp" collects CPU, Memory Utilization
 *    details from Routing Engines and notify anomalies based on threshold 
 *    values.
 * 6) Rule "check-alarm-status-iagent-ha" Monitors system security alarms and 
 *    notifies anomalies when alarms found.
 * 7) Rule "check-appid-asc-cache-status-iagent-ha" Verifies the status of 
 *    application system cache on SRX cluster
 * 8) Rule "check-cpu-memory-utilization-iagent-ha" Monitors spu cpu and memory
 *    utilization and notifies when anomalies are found in SRX cluster.
 * 9) Rule "check-idp-memory-counter-iagent-ha" Monitors idp memory counters 
 *    and notifies when anomalies are found in SRX cluster.
 * 10)Rule "check-idp-memory-utilization-iagent-ha" Monitors idp memory 
 *    utilization and notifies anomalies when utilization exceeds threshold.
 */
healthbot {
    playbook srx-cluster-security-kpis-playbook {
        rules [ security.idp/check-idp-memory-utilization-iagent-ha security.idp/check-idp-memory-counter-iagent-ha security.spu/check-cpu-memory-utilization-iagent-ha security.application/check-appid-asc-cache-status-iagent-ha system.alarm/check-alarm-status-iagent-ha security.spu/check-spu-performance-srx-cluster-netconf security.flow/check-flow-session-summary-srx-cluster-netconf linecard.fpc/check-fpc-cpu-memory-usage-srx-cluster-netconf interface.statistics/check-interface-in-out-traffic-snmp system.cpu.memory/check-system-cpu-memory-snmp ];
        description "Playbook checks SRX cluster system, linecard, SPU's cpu, memory and security parameters";
        synopsis "SRX cluster system, linecard and security performance indicators";
    }
}